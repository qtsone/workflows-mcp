name: image-gen-test
description: Test workflow for ImageGen executor (DALL-E and compatible)
tags: ["llm", "image-gen"]

inputs:
  prompt:
    type: str
    description: Image prompt
    default: "A futuristic city with flying cars"

  output_dir:
    type: str
    description: Directory to save images
    default: "/tmp/mcp-images"

blocks:
  - id: create_dir
    type: Shell
    inputs:
      working_dir: "{{inputs.output_dir}}"
      command: "echo 'Ensuring directory exists'"

  - id: generate_image
    type: ImageGen
    depends_on: [create_dir]
    inputs:
      prompt: "{{inputs.prompt}}"
      model: gpt-image-1
      size: "1024x1024"
      quality: standard
      output_file: "{{inputs.output_dir}}/image.png"

  - id: generate_variation
    type: ImageGen
    depends_on: [generate_image]
    inputs:
      operation: variation
      image: "{{inputs.output_dir}}/image.png"
      model: dall-e-2
      n: 1
      size: "1024x1024"
      output_file: "{{inputs.output_dir}}/variation.png"

  - id: edit_image
    type: ImageGen
    depends_on: [generate_image]
    inputs:
      operation: edit
      prompt: "Add a sunset in the background"
      image: "{{inputs.output_dir}}/image.png"
      model: gpt-image-1
      size: "1024x1024"
      output_file: "{{inputs.output_dir}}/edited.png"

outputs:
  images_dir:
    type: str
    value: "{{inputs.output_dir}}"