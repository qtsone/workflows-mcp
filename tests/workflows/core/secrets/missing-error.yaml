name: secrets-missing-error
description: |
  Test error handling for missing secrets
  Verifies that workflows fail fast with clear error messages
tags: [test, core, secrets, errors]
blocks:
  # This block should fail because NONEXISTENT_SECRET doesn't exist
  - id: use_missing_secret
    type: Shell
    inputs:
      command: echo "This should not execute"
      env:
        MISSING: "{{secrets.NONEXISTENT_SECRET}}"
  # This should be skipped due to dependency failure
  - id: should_be_skipped
    type: Shell
    inputs:
      command: echo "This should be skipped"
    depends_on: [use_missing_secret]
outputs:
  # Workflow should fail, so these outputs test the failure state
  missing_secret_failed:
    value: "{{blocks.use_missing_secret.failed}}"
    type: bool
  dependent_skipped:
    value: "{{blocks.should_be_skipped.skipped}}"
    type: bool
