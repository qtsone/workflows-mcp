name: secrets-shell-basic
description: |
  Test basic secret resolution in Shell blocks
  Verifies secrets are resolved and available as environment variables
tags: [test, core, secrets, shell]
blocks:
  # Test secret resolution in Shell command
  - id: test_secret_in_env
    type: Shell
    inputs:
      command: |
        # Echo the secret (will be redacted in output)
        echo "Secret value: {{secrets.TEST_SECRET}}"
      env:
        MY_SECRET: "{{secrets.TEST_SECRET}}"
        ANOTHER_VAR: "not-a-secret"
  # Verify secret was resolved (check command succeeded)
  - id: verify_resolution
    type: Shell
    inputs:
      command: echo "Secret resolved successfully"
    condition: "{{blocks.test_secret_in_env.succeeded}}"
    depends_on: [test_secret_in_env]
outputs:
  secret_resolved:
    value: "{{blocks.test_secret_in_env.succeeded}}"
    type: bool
  verification_passed:
    value: "{{blocks.verify_resolution.succeeded}}"
    type: bool
  # Output will contain redacted secret
  command_output:
    value: "{{blocks.test_secret_in_env.outputs.stdout}}"
    type: str
