name: dag-execution-optional-deps
description: Test optional dependencies (required:false) - blocks run even when optional deps fail
tags: [test, core, dag, dependencies, optional]
blocks:
  - id: job_1
    description: "This job always succeeds"
    type: Shell
    inputs:
      command: echo "success"
  - id: job_2
    description: "This job always fails"
    type: Shell
    inputs:
      command: exit 1
  - id: job_3
    description: "This job runs only if job_1 succeeds (required dependency)"
    type: Shell
    inputs:
      command: echo "runs_only_if_success"
    depends_on:
      - block: job_1
        required: true
  - id: job_4
    description: "This job runs despite job_2 failing (optional dependency)"
    type: Shell
    inputs:
      command: echo "runs_despite_failure"
    depends_on:
      - block: job_2
        required: false
  - id: job_5
    description: "This job has mixed dependencies (required + optional)"
    type: Shell
    inputs:
      command: echo "mixed_deps_ran"
    depends_on:
      - block: job_1
        required: true
      - block: job_2
        required: false
  - id: job_6
    description: "This job has all optional dependencies"
    type: Shell
    inputs:
      command: echo "job_6_ran"
    depends_on:
      - block: job_2
        required: false
      - block: job_1
        required: false
outputs:
  job_1_succeeded:
    value: "{{blocks.job_1.succeeded}}"
    type: bool
  job_2_failed:
    value: "{{blocks.job_2.failed}}"
    type: bool
  job_3_succeeded:
    value: "{{blocks.job_3.succeeded}}"
    type: bool
  job_4_succeeded:
    value: "{{blocks.job_4.succeeded}}"
    type: bool
  job_5_succeeded:
    value: "{{blocks.job_5.succeeded}}"
    type: bool
  job_6_succeeded:
    value: "{{blocks.job_6.succeeded}}"
    type: bool
