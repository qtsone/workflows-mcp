name: http-basic-get
description: |
  Test basic HttpCall functionality with GET request
  Uses local httpbin mock (via base_url input) for reliable, fast tests
tags: [test, core, http, api]
inputs:
  base_url:
    type: str
    default: "https://httpbin.org"
    description: "Base URL for HTTP endpoints (no trailing slash)"
blocks:
  # Test basic GET request
  - id: get_request
    type: HttpCall
    inputs:
      url: "{{inputs.base_url}}/get"
      method: "GET"
      timeout: 10
  # Test POST request with JSON body
  - id: post_json
    type: HttpCall
    inputs:
      url: "{{inputs.base_url}}/post"
      method: "POST"
      headers:
        Content-Type: "application/json"
        User-Agent: "workflows-mcp-test"
      json:
        test_key: "test_value"
        number: 42
      timeout: 10
    depends_on: [get_request]
  # Test that response is valid JSON
  - id: verify_json_response
    type: Shell
    inputs:
      command: |
        # Verify response_json was parsed
        if [ "{{blocks.post_json.outputs.response_json}}" != "None" ]; then
          echo "JSON parsed successfully"
        else
          echo "JSON parsing failed"
          exit 1
        fi
    depends_on: [post_json]
outputs:
  get_status:
    value: "{{blocks.get_request.outputs.status_code}}"
    type: str
  get_success:
    value: "{{blocks.get_request.succeeded}}"
    type: bool
  post_status:
    value: "{{blocks.post_json.outputs.status_code}}"
    type: str
  post_success:
    value: "{{blocks.post_json.succeeded}}"
    type: bool
  json_verified:
    value: "{{blocks.verify_json_response.succeeded}}"
    type: bool
