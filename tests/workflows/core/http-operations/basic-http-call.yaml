name: http-basic-get
description: |
  Test basic HttpCall functionality with GET request
  Uses httpbin.org for reliable, predictable responses
tags: [test, core, http, api]

blocks:
  # Test basic GET request
  - id: get_request
    type: HttpCall
    inputs:
      url: "https://httpbin.org/get"
      method: "GET"
      timeout: 10

  # Test POST request with JSON body
  - id: post_json
    type: HttpCall
    inputs:
      url: "https://httpbin.org/post"
      method: "POST"
      headers:
        Content-Type: "application/json"
        User-Agent: "workflows-mcp-test"
      body_json:
        test_key: "test_value"
        number: 42
      timeout: 10
    depends_on: [get_request]

  # Test that response is valid JSON
  - id: verify_json_response
    type: Shell
    inputs:
      command: |
        # Verify response_json was parsed
        if [ "{{blocks.post_json.outputs.response_json}}" != "None" ]; then
          echo "JSON parsed successfully"
        else
          echo "JSON parsing failed"
          exit 1
        fi
    depends_on: [post_json]

outputs:
  get_status: "{{blocks.get_request.outputs.status_code}}"
  get_success: "{{blocks.get_request.succeeded}}"
  post_status: "{{blocks.post_json.outputs.status_code}}"
  post_success: "{{blocks.post_json.succeeded}}"
  json_verified: "{{blocks.verify_json_response.succeeded}}"
