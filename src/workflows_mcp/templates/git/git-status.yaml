name: git-status
description: Check git repository status and information
version: "2.0"
author: Workflows MCP Team
tags: [git, status]
inputs:
  working_dir:
    type: str
    description: "(Optional) Path to git repository"
    default: "."
    required: false
blocks:
  - id: analyze_changes
    type: Workflow
    description: "Analyze git repository changes"
    inputs:
      workflow: "git-analyze-changes"
      inputs:
        working_dir: "{{inputs.working_dir}}"
  - id: git_branch
    type: Shell
    description: "Get current git branch name"
    inputs:
      command: git branch --show-current > $SCRATCH/current_branch.txt
      working_dir: "{{inputs.working_dir}}"
      timeout: 5
    outputs:
      name:
        type: str
        path: "$SCRATCH/current_branch.txt"
        description: "Current branch name"
  - id: check_recent_commits
    type: Shell
    inputs:
      command: "git log --oneline -5"
      working_dir: "{{inputs.working_dir}}"
      timeout: 30
    depends_on:
      - analyze_changes
      - git_branch
  - id: summary
    type: Shell
    inputs:
      command: |
        printf "Git Repository Summary:\n"
        printf "- Branch: {{blocks.git_branch.outputs.name}}\n"
        printf "- Has Changes: {{blocks.analyze_changes.outputs.has_changes}}\n"
        printf "- File Status:\n{{blocks.analyze_changes.outputs.summary}}\n"
        printf "- Diff Statistics:\n{{blocks.analyze_changes.outputs.diff}}\n"
        printf "- Recent Commits:\n{{blocks.check_recent_commits.outputs.stdout}}\n"
    depends_on:
      - analyze_changes
      - git_branch
      - check_recent_commits
outputs:
  current_branch:
    value: "{{blocks.git_branch.outputs.name}}"
  summary:
    value: "{{blocks.summary.outputs.stdout}}"
