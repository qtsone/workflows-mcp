name: git-status
description: Check git repository status and information
version: "2.0"
author: Workflows MCP Team
tags: [git, status]
inputs:
  working_dir:
    type: str
    description: "(Optional) Path to git repository"
    default: "."
    required: false
blocks:
  - id: analyze_changes
    type: Workflow
    description: "Analyze git repository changes"
    inputs:
      workflow: "git-analyze-changes"
      inputs:
        working_dir: "{{inputs.working_dir}}"
  - id: git_branch
    type: Shell
    description: "Get current git branch name"
    inputs:
      command: git branch --show-current > $SCRATCH/current_branch.txt
      working_dir: "{{inputs.working_dir}}"
      timeout: 5
    outputs:
      name:
        type: str
        path: "$SCRATCH/current_branch.txt"
        description: "Current branch name"
  - id: check_recent_commits
    type: Shell
    inputs:
      command: "git log --oneline -5"
      working_dir: "{{inputs.working_dir}}"
      timeout: 30
    depends_on:
      - analyze_changes
      - git_branch
  - id: summary
    type: RenderTemplate
    inputs:
      template: |
        Git Repository Summary:
        - Branch: {{ branch_name }}
        - Has Changes: {{ has_changes }}
        - File Status:
        {{ summary }}
        - Diff Statistics:
        {{ diff }}
        - Recent Commits:
        {{ recent_commits }}
      variables:
        branch_name: "{{blocks.git_branch.outputs.name}}"
        has_changes: "{{blocks.analyze_changes.outputs.has_changes}}"
        summary: "{{blocks.analyze_changes.outputs.summary}}"
        diff: "{{blocks.analyze_changes.outputs.diff}}"
        recent_commits: "{{blocks.check_recent_commits.outputs.stdout}}"
    depends_on:
      - analyze_changes
      - git_branch
      - check_recent_commits
outputs:
  current_branch:
    value: "{{blocks.git_branch.outputs.name}}"
  summary:
    value: "{{blocks.summary.outputs.content}}"
