name: cortex-gather-command
description: |
  Atomic capability: Execute shell command for information gathering.
  Read-only operations only - no side effects.

tags: [cortex, capability, atomic, gather, command]

inputs:
  command:
    type: str
    description: Shell command to execute.
    required: true

  working_dir:
    type: str
    description: Working directory.
    required: false
    default: "."

  timeout:
    type: num
    description: Timeout in seconds.
    required: false
    default: 30

blocks:
  - id: execute
    type: Shell
    inputs:
      command: "{{ inputs.command }}"
      working_dir: "{{ inputs.working_dir }}"
      timeout: "{{ inputs.timeout }}"

outputs:
  stdout:
    value: "{{ blocks.execute.outputs.stdout }}"
    type: str
    description: Command standard output.

  stderr:
    value: "{{ blocks.execute.outputs.stderr }}"
    type: str
    description: Command standard error.

  exit_code:
    value: "{{ blocks.execute.outputs.exit_code }}"
    type: num
    description: Exit code (0 = success).

  success:
    value: "{{ blocks.execute.outputs.exit_code == 0 }}"
    type: bool
    description: Whether command succeeded.

  evidence:
    value: "{{ ['command:' ~ inputs.command[:50]] }}"
    type: list
    description: Evidence reference for findings.
