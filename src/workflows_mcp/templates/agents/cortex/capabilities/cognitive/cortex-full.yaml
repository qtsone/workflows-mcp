name: cortex-full
description: |
  Cognitive capability: Run full cognitive cycle.
  Invokes cortex-cell with no mode (runs all phases).

tags: [cortex, capability, cognitive, full]

inputs:
  query:
    type: str
    description: Query to process through full cycle.
    required: true

  context:
    type: dict
    description: Execution context.
    required: true

  state:
    type: str
    description: Path to SQLite state database (auto-created if empty).
    required: false
    default: ""

  depth:
    type: num
    description: Current recursion depth.
    required: false
    default: 0

  max_depth:
    type: num
    description: Maximum recursion depth.
    required: false
    default: 5

  parent_trace:
    type: str
    description: Parent trace ID for linking.
    required: false
    default: ""

blocks:
  - id: full
    type: Workflow
    inputs:
      workflow: cortex-cell
      inputs:
        query: "{{ inputs.query }}"
        mode: ""
        context: "{{ inputs.context }}"
        state: "{{ inputs.state }}"
        depth: "{{ inputs.depth }}"
        max_depth: "{{ inputs.max_depth }}"
        parent_trace: "{{ inputs.parent_trace }}"

outputs:
  answer:
    value: "{{ blocks.full.outputs.answer }}"
    type: str
    description: Final answer from full cognitive cycle.

  synthesis:
    value: "{{ blocks.full.outputs.synthesis }}"
    type: dict
    description: Full synthesis object.

  actions:
    value: "{{ blocks.full.outputs.actions | default([]) }}"
    type: list
    description: Actions taken during cycle.

  trace_id:
    value: "{{ blocks.full.outputs.trace_id }}"
    type: str
    description: Trace ID for this invocation.

  depth:
    value: "{{ blocks.full.outputs.depth }}"
    type: num
    description: Final depth reached.
