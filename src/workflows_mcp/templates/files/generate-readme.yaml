name: generate-readme
description: Generate README.md from template with project metadata
version: "1.0"
author: Workflows MCP Team
tags: [python, files, documentation, template, readme]
inputs:
  project_name:
    type: str
    description: Project name
    default: "My Project"
  description:
    type: str
    description: Project description
    default: "A sample project"
  author:
    type: str
    description: Project author
    default: "Anonymous"
  version:
    type: str
    description: Project version
    default: "1.0.0"
  license:
    type: str
    description: License type
    default: "MIT"
  workspace:
    type: str
    description: Workspace directory path
    default: "."
  template_path:
    type: str
    description: Path to README template file (relative to workspace or absolute)
    default: "README.template.md"
  output_path:
    type: str
    description: Output README path (relative to workspace or absolute)
    default: "README.md"
  create_template_if_missing:
    type: bool
    description: Create default template if template_path doesn't exist
    default: true
blocks:
  # Check if template exists
  - id: check_template
    type: Shell
    inputs:
      command: "test -f {{inputs.workspace}}/{{inputs.template_path}} && echo 'exists' || echo 'missing'"
      timeout: 5
  # Create default template if missing
  - id: create_default_template
    type: CreateFile
    inputs:
      path: "{{inputs.workspace}}/{{inputs.template_path}}"
      content: |
        # {{inputs.project_name}}

        {{inputs.description}}

        ## Installation

        \`\`\`bash
        pip install {{inputs.project_name}}
        \`\`\`

        ## Usage

        \`\`\`python
        import {{inputs.project_name}}
        # Your code here
        \`\`\`

        ## Features

        - Feature 1
        - Feature 2
        - Feature 3

        ## Contributing

        Contributions are welcome! Please feel free to submit a Pull Request.

        ## License

        This project is licensed under the {{inputs.license}} License.

        ## Author

        {{inputs.author}}

        ## Version

        Current version: {{inputs.version}}
    depends_on:
      - check_template
    condition: "{{inputs.create_template_if_missing}} and 'missing' in {{blocks.check_template.outputs.stdout}}"
  # Read template
  - id: read_template
    type: ReadFiles
    inputs:
      patterns: ["{{inputs.template_path}}"]
      base_path: "{{inputs.workspace}}"
      mode: full
    depends_on:
      - check_template
      - create_default_template
    condition: "'exists' in {{blocks.check_template.outputs.stdout}} or {{inputs.create_template_if_missing}}"
  # Write README file (using render() for nested template rendering)
  - id: write_readme
    type: CreateFile
    inputs:
      path: "{{inputs.workspace}}/{{inputs.output_path}}"
      content: "{{render(get(blocks.read_template.outputs.files, 0, {}).content, {'project_name': inputs.project_name, 'description': inputs.description, 'author': inputs.author, 'version': inputs.version, 'license': inputs.license})}}"
    depends_on:
      - read_template
  # Verify README was created
  - id: verify_readme
    type: ReadFiles
    inputs:
      patterns: ["{{inputs.output_path}}"]
      base_path: "{{inputs.workspace}}"
      mode: full
    depends_on:
      - write_readme
  # Generate summary
  - id: summary
    type: Shell
    inputs:
      command: |
        printf "README Generation Summary:\n"
        printf "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n"
        printf "Project: {{inputs.project_name}} v{{inputs.version}}\n"
        printf "Template: {{inputs.template_path}} ({{blocks.check_template.outputs.stdout}})\n"
        printf "Output: {{inputs.output_path}}\n"
        printf "Author: {{inputs.author}}\n"
        printf "License: {{inputs.license}}\n"
        printf "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n"
        printf "Status: ✓ README generated successfully"
    depends_on:
      - verify_readme
outputs:
  success:
    value: "true"
  readme_path:
    value: "{{inputs.workspace}}/{{inputs.output_path}}"
  template_used:
    value: "{{inputs.workspace}}/{{inputs.template_path}}"
  template_created:
    value: "{{inputs.create_template_if_missing}} and 'missing' in {{blocks.check_template.outputs.stdout}}"
  readme_content:
    value: "{{blocks.verify_readme.outputs.content}}"
  readme_size_kb:
    value: "{{blocks.verify_readme.outputs.total_size_kb}}"
    type: num
  summary:
    value: "{{blocks.summary.outputs.stdout}}"
